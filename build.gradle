/*
 * This build file was auto generated by running the Gradle 'init' task
 * by 'tf_octo' at '14/03/01 15:43' with Gradle 1.10
 *
 * This generated file contains a commented-out sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * user guide available at http://gradle.org/docs/1.10/userguide/tutorial_java_projects.html
 */

project.ext {
    dataDirectory = 'data'
    destination = 'dest'
}

repositories {
    mavenCentral()
}

// TODO add dependencies
dependencies {
}

// TODO implement task('clean')
task clean

task generate << {
    // 対象ディレクトリ作成
    file(destination).with {
        if (!exists()) {
            mkdir()
        }
    }

    // 対象ファイル作成
    // TODO 現状はコピーしているだけなのでテンプレートに埋め込むようにする
    readBookmarkData().each { bookmark ->
        file(destination + '/' + bookmark.name).with { File file ->
            if (createNewFile()) {
                println "create file: " + file.name
                setText(bookmark.text)
            }
        }
    }
}

import groovy.io.FileType
def readBookmarkData() {
    def bookmarks = []
    file(dataDirectory).eachFile(FileType.FILES) { File file ->
        bookmarks.add([name:file.name, text:file.getText()])
    }
    return bookmarks
}

task printDataFiles << {
    println "data directory is ${dataDirectory}"
    file(dataDirectory).eachFile(FileType.FILES) { File file ->
        println "# " + file.name
        println file.getText()
    }
}

